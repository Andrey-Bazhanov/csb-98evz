(this["webpackJsonpminecraft-valtio-yjs-demo"]=this["webpackJsonpminecraft-valtio-yjs-demo"]||[]).push([[0],{74:function(e,t,r){},97:function(e,t,r){"use strict";r.r(t);var c=r(12),n=r(6),a=r(62),o=r.n(a),i=r(68),s=(r(74),r(24)),u=r(100),j=r(101),b=r(36),l=r(10),O=r(4),d=r.p+"static/media/grass.eb5fc8eb.jpg",f=r(15),m=function(e){var t=Object(b.c)((function(){return Object(l.a)({rotation:[-Math.PI/2,0,0]},e)})),r=Object(c.a)(t,1)[0],n=Object(s.c)(O.TextureLoader,d);return n.wrapS=n.wrapT=O.RepeatWrapping,Object(f.jsxs)("mesh",{ref:r,receiveShadow:!0,children:[Object(f.jsx)("planeGeometry",{args:[1e3,1e3]}),Object(f.jsx)("meshStandardMaterial",{map:n,"map-repeat":[240,240],color:"green"})]})},p=r(11),h=r(99),x=r.p+"static/media/axe.9fbbc709.glb";function y(e){var t=Object(n.useRef)(),r=Object(h.a)(x),c=r.nodes,a=r.materials;return Object(f.jsx)("group",Object(l.a)(Object(l.a)({ref:t,dispose:null},e),{},{children:Object(f.jsxs)("group",{rotation:[0,Math.PI/1.8,-.3],scale:.5,children:[Object(f.jsx)("mesh",{geometry:c.Mesh_1001_1.geometry,material:a.material_2}),Object(f.jsx)("mesh",{geometry:c.Mesh_1001_2.geometry,material:a.material_3})]})}))}h.a.preload("/axe.glb");var g={KeyW:"forward",KeyS:"backward",KeyA:"left",KeyD:"right",Space:"jump"},v=function(e){return g[e]},w=new O.Vector3,k=new O.Vector3,S=new O.Vector3,M=new O.Vector3,E=new O.Vector3,P=function(e){var t=Object(n.useRef)(),r=Object(b.d)((function(){return Object(l.a)({mass:1,type:"Dynamic",position:[0,10,0]},e)})),a=Object(c.a)(r,2),o=a[0],i=a[1],u=function(){var e=Object(n.useState)({forward:!1,backward:!1,left:!1,right:!1,jump:!1}),t=Object(c.a)(e,2),r=t[0],a=t[1];return Object(n.useEffect)((function(){var e=function(e){return a((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(p.a)({},v(e.code),!0))}))},t=function(e){return a((function(t){return Object(l.a)(Object(l.a)({},t),{},Object(p.a)({},v(e.code),!1))}))};return document.addEventListener("keydown",e),document.addEventListener("keyup",t),function(){document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}}),[]),r}(),j=u.forward,d=u.backward,m=u.left,h=u.right,x=u.jump,g=Object(s.d)().camera,P=Object(n.useRef)([0,0,0]);return Object(n.useEffect)((function(){return i.velocity.subscribe((function(e){return P.current=e}))}),[]),Object(s.b)((function(e){o.current.getWorldPosition(g.position),k.set(0,0,Number(d)-Number(j)),S.set(Number(m)-Number(h),0,0),w.subVectors(k,S).normalize().multiplyScalar(5).applyEuler(g.rotation),E.fromArray(P.current),t.current.children[0].rotation.x=O.MathUtils.lerp(t.current.children[0].rotation.x,Math.sin((E.length()>1)*e.clock.elapsedTime*10)/6,.1),t.current.rotation.copy(g.rotation),t.current.position.copy(g.position).add(g.getWorldDirection(M).multiplyScalar(1)),i.velocity.set(w.x,P.current[1],w.z),x&&Math.abs(P.current[1].toFixed(2))<.05&&i.velocity.set(P.current[0],10,P.current[2])})),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("mesh",{ref:o}),Object(f.jsx)("group",{ref:t,onPointerMissed:function(e){return t.current.children[0].rotation.x=-.5},children:Object(f.jsx)(y,{position:[.3,-.35,.5]})})]})},L=r(16),N=r(48),C=r(23),V=r(67),_=r(69),I=r.p+"static/media/dirt.59ed3279.jpg",A=new C.b;new _.a("minecraft-valtio-yjs-demo-2",A);var K=A.getMap("map"),R=Object(N.a)({cubes:[]}),T=function(e,t,r){R.cubes.push([e,t,r])};Object(V.a)(R,K);var W=function(){return function(){var e=Object(n.useState)((function(){return Object(N.b)(R).cubes})),t=Object(c.a)(e,2),r=t[0],a=t[1];return Object(n.useEffect)((function(){return Object(N.c)(R,(function(){a(Object(N.b)(R).cubes)}))}),[]),r||[]}().map((function(e,t){return Object(f.jsx)(z,{position:e},t)}))},z=function(e){var t=Object(b.b)((function(){return Object(l.a)({type:"Static"},e)})),r=Object(c.a)(t,1)[0],a=Object(n.useState)(null),o=Object(c.a)(a,2),i=o[0],u=o[1],j=Object(s.c)(O.TextureLoader,I),d=Object(n.useCallback)((function(e){return e.stopPropagation(),u(Math.floor(e.faceIndex/2))}),[]),m=Object(n.useCallback)((function(){return u(null)}),[]),p=Object(n.useCallback)((function(e){e.stopPropagation();var t=r.current.position,c=t.x,n=t.y,a=t.z,o=[[c+1,n,a],[c-1,n,a],[c,n+1,a],[c,n-1,a],[c,n,a+1],[c,n,a-1]];T.apply(void 0,Object(L.a)(o[Math.floor(e.faceIndex/2)]))}),[]);return Object(f.jsxs)("mesh",{ref:r,receiveShadow:!0,castShadow:!0,onPointerMove:d,onPointerOut:m,onClick:p,children:[Object(L.a)(Array(6)).map((function(e,t){return Object(f.jsx)("meshStandardMaterial",{attachArray:"material",map:j,color:i===t?"hotpink":"white"},t)})),Object(f.jsx)("boxGeometry",{})]})};function D(){return Object(f.jsxs)(s.a,{shadows:!0,gl:{alpha:!1},camera:{fov:45},raycaster:{computeOffsets:function(e){return{offsetX:e.target.width/2,offsetY:e.target.height/2}}},children:[Object(f.jsx)(u.a,{sunPosition:[100,20,100]}),Object(f.jsx)("ambientLight",{intensity:.3}),Object(f.jsx)("pointLight",{castShadow:!0,intensity:.8,position:[100,100,100]}),Object(f.jsxs)(b.a,{gravity:[0,-30,0],children:[Object(f.jsx)(m,{}),Object(f.jsx)(P,{}),Object(f.jsx)(z,{position:[0,.5,-10]}),Object(f.jsx)(W,{})]}),Object(f.jsx)(j.a,{})]})}function F(){var e=Object(n.useState)(!1),t=Object(c.a)(e,2),r=t[0],a=t[1];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(D,{}),Object(f.jsx)("div",{className:"dot"}),Object(f.jsxs)("div",{className:"fullscreen bg ".concat(r?"ready":"notready"," ").concat(r&&"clicked"),children:[Object(f.jsx)("div",{className:"stack",children:Object(f.jsx)("button",{onClick:function(){return a(!0)},children:"Click (needs fullscreen)"})}),Object(f.jsx)(i.a,{date:"16. June",year:"2021"})]})]})}o.a.render(Object(f.jsx)(F,{}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.e26d831f.chunk.js.map